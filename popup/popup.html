<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div id="app">
    <header>
      <h1>Smart Scraper</h1>
      <div style="display:flex;align-items:center;gap:8px;">
        <span id="site-type-badge" class="badge hidden"></span>
        <button id="btn-settings" class="btn-settings-icon" title="API Settings">&#9881;</button>
      </div>
    </header>

    <!-- Settings Panel -->
    <section id="settings-section" class="hidden">
      <h2>Contact Enrichment API</h2>
      <p class="summary-text">
        Enrich LinkedIn contacts with email &amp; phone via a third-party API.
        Sign up for a free key at your chosen provider.
      </p>

      <div class="settings-field">
        <label class="settings-label" for="provider-select">Provider</label>
        <select id="provider-select" class="settings-select">
          <option value="hunter">Hunter.io (email only)</option>
          <option value="apollo">Apollo.io (email + phone)</option>
          <option value="snov">Snov.io (email)</option>
        </select>
      </div>

      <div class="settings-field">
        <label class="settings-label" for="api-key-input">API Key</label>
        <input id="api-key-input" class="settings-input" type="password"
               placeholder="Paste your API key here" autocomplete="off" />
      </div>

      <div id="provider-hint" class="settings-hint"></div>

      <div class="button-group" style="margin-top:10px;">
        <button id="btn-save-settings" class="btn btn-primary" style="font-size:12px;padding:8px;">Save</button>
        <button id="btn-clear-settings" class="btn btn-secondary" style="font-size:12px;padding:8px;margin-top:0;">Clear</button>
      </div>
      <p id="settings-status" class="settings-status hidden"></p>
    </section>

    <section id="status-section">
      <div class="spinner"></div>
      <p id="status-text">Analyzing page...</p>
    </section>

    <section id="error-section" class="hidden">
      <p id="error-text" class="error-text"></p>
    </section>

    <section id="options-section" class="hidden">
      <p id="data-summary" class="summary-text"></p>
      <button id="btn-scrape" class="btn btn-primary">
        <span class="btn-icon">&#9881;</span> Scrape Page
      </button>
    </section>

    <section id="scraping-section" class="hidden">
      <div class="spinner"></div>
      <p>Extracting data...</p>
    </section>

    <section id="result-section" class="hidden">
      <p id="result-summary" class="summary-text"></p>

      <div id="contact-cards" class="hidden">
        <h2>Contact Info</h2>
        <div id="contact-cards-list"></div>
      </div>

      <h2>Export Data</h2>
      <div class="button-group">
        <button id="btn-pdf" class="btn btn-export">
          <span class="btn-icon">&#128196;</span> PDF
        </button>
        <button id="btn-excel" class="btn btn-export">
          <span class="btn-icon">&#128202;</span> Excel
        </button>
        <button id="btn-csv" class="btn btn-export">
          <span class="btn-icon">&#128203;</span> CSV
        </button>
      </div>
      <button id="btn-rescrape" class="btn btn-secondary">Scrape Again</button>
    </section>
  </div>

  <iframe id="sandbox-frame" src="../sandbox/sandbox.html"
          style="display:none;" sandbox="allow-scripts"></iframe>

  <script src="../utils/message-types.js"></script>
  <script src="../lib/xlsx.full.min.js"></script>
  <script src="../utils/csv-generator.js"></script>
  <script src="../utils/enrichment.js"></script>
  <script src="popup.js"></script>
</body>
</html>
